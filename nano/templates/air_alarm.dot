<div class="notice">
	{{? data.siliconUser}}
		<div class="itemContentSmall">
			Interface Lock:
		</div>
		<div class="itemContentFull">
			{{=helper.link('Engaged', 'locked', {'toggleaccess': 1}, data.locked ? 'selected' : null)}}
			{{=helper.link('Disengaged', 'unlocked', {'toggleaccess': 1}, data.locked ? null : 'selected')}}
		</div>
		<div class="clearBoth"></div>
	{{??}}
		{{? data.locked}}
			Swipe an ID card to unlock this interface.
		{{??}}
			Swipe an ID card to lock this interface.
		{{?}}
	{{?}}
</div>
<h2>Air Status</h2>
<div class="statusDisplay">
	{{? data.environment_data}}
		{{~ data.environment_data:info:i}}
			<div class="item">
				<div class="itemLabel">
					{{=info.name}}:
				</div>
				<div class="itemContent">
					{{? info.danger_level == 2}}
						<span class='bad'>
					{{?? info.danger_level == 1}}
						<span class='average'>
					{{??}}
						<span class='good'>
					{{?}}
					{{=helper.fixed(info.value, 2)}}</span>{{=info.unit}}
				</div>
			</div>
		{{~}}
		<div class="item">
			<div class="itemLabel">
				Local Status:
			</div>
			<div class="itemContent">
				{{? data.danger_level == 2}}
					<span class='bad bold'>Danger (Internals Required)</span>
				{{?? data.danger_level == 1}}
					<span class='average bold'>Caution</span>
				{{??}}
					<span class='good'>Optimal</span>
				{{?}}
			</div>
		</div>
		<div class="item">
			<div class="itemLabel">
				Area Status:
			</div>
			<div class="itemContent">
				{{? data.atmos_alarm}}
					<span class='bad bold'>Atmosphere Alarm</span>
				{{?? data.fire_alarm}}
					<span class='bad bold'>Fire Alarm</span>
				{{??}}
					<span class='good'>Nominal</span>
				{{?}}
			</div>
		</div>
	{{??}}
		<div class="item"><span class='bad bold'>Warning: Cannot obtain air sample for analysis.</span></div>
	{{?}}
	{{? data.dangerous}}
		<hr />
		<div class="item"><span class='bad bold'>Warning: Safety measures offline. Device may exhibit abnormal behavior.</span></div>
	{{?}}
</div>
{{? (!data.locked || data.siliconUser)}}
	{{? data.screen != 1}}
		<div class="item">{{=helper.link('Back', 'arrow-left', {'screen': 1})}}</div>
	{{?}}
	{{? data.screen == 1}}
		<h2>Air Controls</h2>
		<div class="statusDisplay">
		<div class="item">
			{{? !data.atmos_alarm}}
				{{=helper.link('Area Atmospheric Alarm', 'hand-stop-o', {'atmos_alarm': 1})}}
			{{??}}
				{{=helper.link('Area Atmospheric Alarm', 'close', {'atmos_reset': 1}, null, 'caution')}}
			{{?}}
		</div>
		<div class="item">
			{{? data.mode != 3}}
				{{=helper.link('Panic Siphon', 'exclamation', {'mode': 3})}}
			{{??}}
				{{=helper.link('Panic Siphon', 'close', {'mode': 1}, null, 'danger')}}
			{{?}}
		</div>
		<br />
		<div class="item">
				{{=helper.link('Vent Controls', 'sign-out', {'screen': 2})}}
			</div>
			<div class="item">
				{{=helper.link('Scrubber Controls', 'filter', {'screen': 3})}}
			</div>
			<br />
			<div class="item">
				{{=helper.link('Set Environmental Mode', 'cog', {'screen': 4})}}
			</div>
			<div class="item">
				{{=helper.link('Set Alarm Threshold', 'bar-chart', {'screen': 5})}}
			</div>
		</div>
	{{?? data.screen == 2}}
		<h2>Vent Controls</h2>
		{{~ data.vents:vent:i}}
			<h3>{{=vent.long_name}}</h3>
			<div class="statusDisplay">
				<div class="item">
					<div class="itemLabel">
						Power:
					</div>
					<div class="itemContent">
						{{? vent.power}}
							{{=helper.link('On', 'power-off', {'id_tag': vent.id_tag, 'command': 'power', 'val': 0}, null, null)}}
						{{??}}
							{{=helper.link('Off', 'close', {'id_tag': vent.id_tag, 'command': 'power', 'val': 1}, null, 'danger')}}
						{{?}}
					</div>
				</div>
				<div class="item">
					<div class="itemLabel">
						Mode:
					</div>
					<div class="itemContent">
						{{? vent.direction == "sipho"}}
							<span class="bad">Siphoning</span>
						{{??}}
							<span class="good">Pressurizing</span>
						{{?}}
					</div>
				</div>
				<div class="item">
					<div class="itemLabel">
						Pressure Checks:
					</div>
					<div class="itemContent">
						{{=helper.link('Internal', 'sign-in', {'id_tag': vent.id_tag, 'command': 'incheck', 'val': vent.checks}, null, vent.incheck ? 'selected' : null)}}
						{{=helper.link('External', 'sign-out', {'id_tag': vent.id_tag, 'command': 'excheck', 'val': vent.checks}, null, vent.excheck ? 'selected' : null)}}
					</div>
				</div>
				<div class="item">
					<div class="itemLabel">
						Set Pressure:
					</div>
					<div class="itemContent">
						{{=helper.link(helper.fixed(vent.external), 'pencil', {'id_tag': vent.id_tag, 'command': 'set_external_pressure'})}}
						{{=helper.link('Reset', 'refresh', { 'id_tag': vent.id_tag, 'command': 'reset_external_pressure'}, vent.default ? 'disabled' : null)}}
					</div>
				</div>
			</div>
		{{~}}
		{{? !data.vents.length}}
			No vents connected.
		{{?}}
	{{?? data.screen == 3}}
		<h2>Scrubber Controls</h2>
		{{~ data.scrubbers:scrubber:i}}
			<h3>{{=scrubber.long_name}}</h3>
			<div class="statusDisplay">
				<div class="item">
					<div class="itemLabel">
						Power:
					</div>
					<div class="itemContent">
						{{? scrubber.power}}
							{{=helper.link('On', 'power-off', {'id_tag': scrubber.id_tag, 'command': 'power', 'val': 0}, null, null)}}
						{{??}}
							{{=helper.link('Off', 'close', {'id_tag': scrubber.id_tag, 'command': 'power', 'val': 1}, null, 'danger')}}
						{{?}}
					</div>
				</div>
				<div class="item">
					<div class="itemLabel">
						Mode:
					</div>
					<div class="itemContent">
						{{? scrubber.scrubbing}}
							{{=helper.link('Scrubbing', 'filter', {'id_tag': scrubber.id_tag, 'command': 'scrubbing', 'val': 0}, null, null)}}
						{{??}}
							{{=helper.link('Siphoning', 'sign-in', {'id_tag': scrubber.id_tag, 'command': 'scrubbing', 'val': 1}, null, 'danger')}}
						{{?}}
					</div>
				</div>
				<div class="item">
					<div class="itemLabel">
						Range:
					</div>
					<div class="itemContent">
						{{? scrubber.widenet}}
							{{=helper.link('Extended', 'expand', {'id_tag': scrubber.id_tag, 'command': 'widenet', 'val': 0}, null, 'caution')}}
						{{??}}
							{{=helper.link('Normal', 'compress', {'id_tag': scrubber.id_tag, 'command': 'widenet', 'val': 1}, null, null)}}
						{{?}}
					</div>
				</div>
				<div class="item">
					<div class="itemLabel">
						Filters:
					</div>
					<div class="itemContent">
						{{=helper.link("CO2", scrubber.filter_co2 ? 'check-square-o' : 'square-o', {'id_tag': scrubber.id_tag, 'command': "co2_scrub", 'val': scrubber.filter_co2 ? 0 : 1}, null, scrubber.filter_co2 ? 'selected' : null)}}
						{{=helper.link("N2O", scrubber.filter_n2o ? 'check-square-o' : 'square-o', {'id_tag': scrubber.id_tag, 'command': "n2o_scrub", 'val': scrubber.filter_n2o ? 0 : 1}, null, scrubber.filter_n2o ? 'selected' : null)}}
						{{=helper.link("Plasma", scrubber.filter_toxins ? 'check-square-o' : 'square-o', {'id_tag': scrubber.id_tag, 'command': "tox_scrub", 'val': scrubber.filter_toxins ? 0 : 1}, null, scrubber.filter_toxins ? 'selected' : null)}}
					</div>
				</div>
			</div>
		{{~}}
		{{? !data.scrubbers.length}}
			No scrubbers connected.
		{{?}}
	{{?? data.screen == 4}}
		<h2>Environmental Modes</h2>
		<div class="statusDisplay">
			{{~ data.modes:mode:i}}
				<div class="item">
					{{=helper.link(mode.name, mode.selected ? 'check-square-o' : 'square-o', {'mode': mode.mode}, null, mode.selected ? (mode.danger ? 'danger' : 'selected') : null)}}
				</div>
			{{~}}
		</div>
	{{?? data.screen == 5}}
		<h2>Alarm Thresholds</h2>
		<div class="statusDisplay">
			<table class="fixed">
				<tr>
					<td></td><td><span class='bad'>min2</span></td><td><span class='average'>min1</span></td><td><span class='average'>max1</span></td><td><span class='bad'>max2</span></td>
				</tr>
				{{~ data.thresholds:threshold:i}}
					<tr>
						<td>{{=threshold.name}}</td>
						{{~ threshold.settings:setting:j}}
							<td>
								{{=helper.link(setting.selected >= 0 ? helper.round(setting.selected*100)/100 : "Off", null, {'command': 'set_threshold', 'env': setting.env, 'var': setting.val})}}
							</td>
						{{~}}
					</tr>
				{{~}}
			<table>
		</div>
	{{?}}
{{?}}
